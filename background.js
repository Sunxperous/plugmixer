// Generated by CoffeeScript 1.7.1
'use strict';
var ACTIVE_ICON_19, ACTIVE_ICON_38, INACTIVE_ICON_19, INACTIVE_ICON_38, NOTIFY_IF;

INACTIVE_ICON_19 = 'images/icon19bw.png';

INACTIVE_ICON_38 = 'images/icon38bw.png';

ACTIVE_ICON_19 = 'images/icon19.png';

ACTIVE_ICON_38 = 'images/icon38.png';

NOTIFY_IF = '1.1.1';

chrome.runtime.onMessage.addListener(function(message, sender, sendResponseTo) {
  switch (message) {
    case "plugmixer_make_inactive":
      chrome.pageAction.setIcon({
        "tabId": sender.tab.id,
        "path": {
          "19": INACTIVE_ICON_19,
          "38": INACTIVE_ICON_38
        }
      });
      chrome.pageAction.show(sender.tab.id);
      return chrome.pageAction.setTitle({
        'tabId': sender.tab.id,
        'title': 'Plugmixer (inactive)'
      });
    case "plugmixer_make_active":
      chrome.pageAction.setIcon({
        "tabId": sender.tab.id,
        "path": {
          "19": ACTIVE_ICON_19,
          "38": ACTIVE_ICON_38
        }
      });
      chrome.pageAction.show(sender.tab.id);
      return chrome.pageAction.setTitle({
        'tabId': sender.tab.id,
        'title': 'Plugmixer'
      });
  }
});

chrome.runtime.onInstalled.addListener(function(details) {
  var curr, prev;
  chrome.storage.sync.remove('indicator');
  if (details.previousVersion != null) {
    prev = details.previousVersion.split('.');
    curr = chrome.runtime.getManifest().version.split('.');
    if (curr[0] > prev[0] || (curr[0] === prev[0] && curr[1] > prev[1]) || chrome.runtime.getManifest().version === NOTIFY_IF) {
      return chrome.storage.sync.set({
        'updated': true
      });
    }
  }
});
